name: CouchCMS Infoleak CVE-2018-7662
manual: true
query: title="CouchCMS" || body="Powered by CouchCMS"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /includes/mysql2i/mysql2i.func.php
    expression: 'response.status == 200 && response.body.bcontains(b"mysql2i.func.php
      on line 10") && response.body.bcontains(b"Fatal error: Cannot redeclare mysql_affected_rows()
      in")'
  r1:
    request:
      method: GET
      path: /addons/phpmailer/phpmailer.php
    expression: 'response.status == 200 && response.body.bcontains(b"phpmailer.php
      on line 10") && response.body.bcontains(b"Fatal error: Call to a menber function
      add_event_listener() on a non-object in")'
expression: r0() && r1()
detail:
  links:
  - https://github.com/CouchCMS/CouchCMS/issues/46
  description: A simple open-source CMS for designers.
  tags: infoleak
